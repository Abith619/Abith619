{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/./externalModules.js","webpack://[name]/./arrayBufferToImage.js","webpack://[name]/./createImage.js","webpack://[name]/./loadImage.js","webpack://[name]/./fileManager.js","webpack://[name]/./index.js","webpack://[name]/./registerLoaders.js","webpack://[name]/./parseImageId.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","m","cornerstone","external","cs","arrayBuffer","Promise","resolve","reject","image","Image","arrayBufferView","Uint8Array","blob","Blob","urlCreator","URL","webkitURL","imageUrl","createObjectURL","src","onload","revokeObjectURL","onerror","error","imageId","rows","naturalHeight","columns","naturalWidth","minPixelValue","maxPixelValue","slope","intercept","windowCenter","windowWidth","render","renderWebImage","getPixelData","context","lastImageIdDrawn","canvas","getContext","height","width","drawImage","getImageData","data","getCanvas","getImage","color","rgba","columnPixelSpacing","undefined","rowPixelSpacing","invert","sizeInBytes","document","createElement","loadImage","parsedImageId","fileIndex","parseInt","url","file","fileManager","get","scheme","promise","fileReader","FileReader","e","imageAsArrayBuffer","target","result","then","imageObject","readAsArrayBuffer","configure","opts","files","add","push","addBuffer","index","remove","purge","cornerstoneFileImageLoader","arrayBufferToImage","createImage","registerImageLoader","firstColonIndex","indexOf","substring","frameIndex","frame","frameStr","substr","c","d","name","getter","o","Object","defineProperty","enumerable","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","call","p","s","moduleId","i","l","modules"],"mappings":"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","file":"cornerstoneFileImageLoader.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cornerstoneFileImageLoader\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cornerstoneFileImageLoader\"] = factory();\n\telse\n\t\troot[\"cornerstoneFileImageLoader\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","import registerLoaders from './registerLoaders.js';\r\n\r\nlet cornerstone;\r\n\r\nconst external = {\r\n  set cornerstone (cs) {\r\n    cornerstone = cs;\r\n\r\n    registerLoaders(cornerstone);\r\n  },\r\n  get cornerstone () {\r\n    return cornerstone;\r\n  }\r\n};\r\n\r\nexport { external };\r\n","/**\r\n * Convert array buffer to image. Returns a promise that resolves to an Image object for the bytes in arrayBuffer\r\n *\r\n * @param arrayBuffer - arrayBuffer with bytes for a web image (e.g. JPEG, PNG, etc)\r\n * @returns {Promise} Promise that resolves to an Image object\r\n */\r\nexport default function (arrayBuffer) {\r\n  return new Promise((resolve, reject) => {\r\n    const image = new Image();\r\n    const arrayBufferView = new Uint8Array(arrayBuffer);\r\n    const blob = new Blob([arrayBufferView]);\r\n    const urlCreator = window.URL || window.webkitURL;\r\n    const imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n    image.src = imageUrl;\r\n    image.onload = () => {\r\n      resolve(image);\r\n      urlCreator.revokeObjectURL(imageUrl);\r\n    };\r\n\r\n    image.onerror = (error) => {\r\n      urlCreator.revokeObjectURL(imageUrl);\r\n      reject(error);\r\n    };\r\n  });\r\n}\r\n","import { external } from './externalModules.js';\r\n\r\nconst canvas = document.createElement('canvas');\r\nlet lastImageIdDrawn;\r\n\r\n/**\r\n * creates a cornerstone Image object for the specified Image and imageId\r\n *\r\n * @param image - An Image\r\n * @param imageId - the imageId for this image\r\n * @returns Cornerstone Image Object\r\n */\r\nexport default function (image, imageId) {\r\n  // extract the attributes we need\r\n  const rows = image.naturalHeight;\r\n  const columns = image.naturalWidth;\r\n\r\n  function getPixelData () {\r\n    const imageData = getImageData();\r\n\r\n\r\n    return imageData.data;\r\n  }\r\n\r\n  function getImageData () {\r\n    let context;\r\n\r\n    if (lastImageIdDrawn === imageId) {\r\n      context = canvas.getContext('2d');\r\n    } else {\r\n      canvas.height = image.naturalHeight;\r\n      canvas.width = image.naturalWidth;\r\n      context = canvas.getContext('2d');\r\n      context.drawImage(image, 0, 0);\r\n      lastImageIdDrawn = imageId;\r\n    }\r\n\r\n    return context.getImageData(0, 0, image.naturalWidth, image.naturalHeight);\r\n  }\r\n\r\n  function getCanvas () {\r\n    if (lastImageIdDrawn === imageId) {\r\n      return canvas;\r\n    }\r\n\r\n    canvas.height = image.naturalHeight;\r\n    canvas.width = image.naturalWidth;\r\n    const context = canvas.getContext('2d');\r\n\r\n    context.drawImage(image, 0, 0);\r\n    lastImageIdDrawn = imageId;\r\n\r\n    return canvas;\r\n  }\r\n\r\n  // Extract the various attributes we need\r\n  return {\r\n    imageId,\r\n    minPixelValue: 0,\r\n    maxPixelValue: 255,\r\n    slope: 1,\r\n    intercept: 0,\r\n    windowCenter: 128,\r\n    windowWidth: 255,\r\n    render: external.cornerstone.renderWebImage,\r\n    getPixelData,\r\n    getCanvas,\r\n    getImage: () => image,\r\n    rows,\r\n    columns,\r\n    height: rows,\r\n    width: columns,\r\n    color: true,\r\n    rgba: false,\r\n    columnPixelSpacing: undefined,\r\n    rowPixelSpacing: undefined,\r\n    invert: false,\r\n    sizeInBytes: rows * columns * 4\r\n  };\r\n}\r\n","import { external } from './externalModules.js';\r\nimport arrayBufferToImage from './arrayBufferToImage.js';\r\nimport createImage from './createImage.js';\r\nimport parseImageId from './parseImageId.js';\r\nimport fileManager from './fileManager.js';\r\n\r\n//\r\n// This is a Cornerstone image loader for images (PNG, JPG) using the HTML5 File API \r\n//\r\n\r\nlet options = {\r\n\r\n};\r\n\r\n// Loads an image given a url to an image\r\nexport function loadImage (imageId) {\r\n  const parsedImageId = parseImageId(imageId);\r\n  const fileIndex = parseInt(parsedImageId.url, 10);\r\n  const file = fileManager.get(fileIndex);\r\n\r\n  if (parsedImageId.scheme === 'imagefile') {\r\n\r\n    const promise = new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.onload = (e) => {\r\n        const imageAsArrayBuffer = e.target.result;\r\n        const imagePromise = arrayBufferToImage(imageAsArrayBuffer);\r\n        imagePromise.then((image) => {\r\n          const imageObject = createImage(image, imageId);\r\n          resolve(imageObject);\r\n        }, reject);\r\n      };\r\n\r\n      fileReader.onerror = reject;\r\n\r\n      fileReader.readAsArrayBuffer(file);\r\n    });\r\n\r\n    return {\r\n      promise\r\n    };   \r\n\r\n  } else if (parsedImageId.scheme === 'imagebuffer') {\r\n\r\n    const promise = new Promise((resolve, reject) => {\r\n      if (file !== null && file !== undefined) {\r\n        const imageAsArrayBuffer = file;\r\n        const imagePromise = arrayBufferToImage(imageAsArrayBuffer);\r\n        imagePromise.then((image) => {\r\n          const imageObject = createImage(image, imageId);\r\n          resolve(imageObject);\r\n        }, reject);\r\n      } else {\r\n        reject('buffer is null or undefined');\r\n      }\r\n    });\r\n\r\n    return {\r\n      promise\r\n    };   \r\n  }\r\n}\r\n\r\nexport function configure (opts) {\r\n  options = opts;\r\n}\r\n","let files = [];\n\nfunction add (file) {\n  const fileIndex = files.push(file);\n\n  return `imagefile:${fileIndex - 1}`;\n}\n\nfunction addBuffer (file) {\n  const fileIndex = files.push(file);\n\n  return `imagebuffer:${fileIndex - 1}`;\n}\n\nfunction get (index) {\n  return files[index];\n}\n\nfunction remove (index) {\n  files[index] = undefined;\n}\n\nfunction purge () {\n  files = [];\n}\n\nexport default {\n  add,\n  addBuffer,\n  get,\n  remove,\n  purge\n};\n","import arrayBufferToImage from './arrayBufferToImage.js';\r\nimport createImage from './createImage.js';\r\nimport fileManager from './fileManager.js';\r\nimport { loadImage, configure } from './loadImage.js';\r\nimport { external } from './externalModules.js';\r\n\r\nconst cornerstoneFileImageLoader = {\r\n  arrayBufferToImage,\r\n  createImage,\r\n  loadImage,\r\n  configure,\r\n  external,\r\n  fileManager\r\n};\r\n\r\nexport {\r\n  arrayBufferToImage,\r\n  createImage,\r\n  loadImage,\r\n  configure,\r\n  external,\r\n  fileManager\r\n};\r\n\r\nexport default cornerstoneFileImageLoader;\r\n","import { loadImage } from './loadImage.js';\r\n\r\nexport default function (cornerstone) {\r\n  // Register the file prefixes so we can use HTML5 File API to work with local files\r\n  cornerstone.registerImageLoader('imagefile', loadImage);\r\n  cornerstone.registerImageLoader('imagebuffer', loadImage);\r\n}\r\n","function parseImageId (imageId) {\n  // build a url by parsing out the url scheme and frame index from the imageId\n  const firstColonIndex = imageId.indexOf(':');\n  let url = imageId.substring(firstColonIndex + 1);\n  const frameIndex = url.indexOf('frame=');\n  let frame;\n\n  if (frameIndex !== -1) {\n    const frameStr = url.substr(frameIndex + 6);\n\n    frame = parseInt(frameStr, 10);\n    url = url.substr(0, frameIndex - 1);\n  }\n\n  return {\n    scheme: imageId.substr(0, firstColonIndex),\n    url,\n    frame\n  };\n}\n\nexport default parseImageId;\n"],"sourceRoot":""}